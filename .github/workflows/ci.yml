# ðŸ“„ CI Pipeline Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð° Ð¸ ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ ÐºÐ¾Ð´Ð°

name: CI

# ðŸ” Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð»ÑŽÐ±Ð¾Ð¼ Ð¿ÑƒÑˆÐµ Ð¸Ð»Ð¸ pull request Ð² Ð»ÑŽÐ±Ð¾Ð¹ Ð²ÐµÑ‚ÐºÐµ
on: [push, pull_request]

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Checkout repo
        uses: actions/checkout@v4

      - name: ðŸ§° Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'yarn'

      - name: ðŸ“¦ Install dependencies (Yarn)
        run: yarn install --frozen-lockfile

      - name: ðŸ” Lint
        run: yarn lint

      - name: ðŸ§¼ Prettier check
        run: yarn prettier --check .

      - name: ðŸ§  Typecheck
        run: yarn tsc --noEmit

      - name: ðŸ§ª Test
        run: yarn test --coverage

      - name: ðŸ— Build
        run: yarn build

      - name: âœ… Commitlint check
        if: github.event_name == 'push'
        run: |
          git log -1 --pretty=format:%s > commit-msg.txt
          yarn commitlint --edit commit-msg.txt
